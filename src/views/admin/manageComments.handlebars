<div class="container">
    <h1><i data-lucide="message-circle"></i> Comentários</h1>

    <h2>Adicionar Novo Depoimento</h2>
    <div class="card">
        <form action="/admin/comments" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <input type="text" name="nome" placeholder="Nome do cliente" required>
            </div>
            <div class="form-group">
                <textarea name="comentario" placeholder="Escreva o depoimento aqui..." required></textarea>
            </div>
            <div class="form-group">
                <label>Foto do Perfil (Opcional)</label>
                <input type="file" name="img" accept="image/*" class="file-custom">
            </div>
            <button type="submit" class="btn btn-primary">
                <i data-lucide="plus" style="width:18px"></i> Adicionar Comentário
            </button>
        </form>
    </div>

    <div class="divider"></div>

    <h2>Gerenciar Existentes</h2>
    
    {{#each comentarios}}
    <div class="card">
        <form action="/admin/comments/update" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="id" value="{{this.id}}">
            
            <div class="form-group">
                <label>Nome:</label>
                <input type="text" name="nome" value="{{this.nome}}" required>
            </div>
            
            <div class="form-group">
                <label>Depoimento:</label>
                <textarea name="comentario" required>{{this.comentario}}</textarea>
            </div>
            
            <div class="img-preview-container">
                {{#if this.img}}
                    <img src="/img/comentes/{{this.img}}" alt="Comentário" width="50" height="50">
                    <input type="hidden" name="imgName" value="{{this.img}}">
                    <span style="font-size: 12px; color: var(--text-muted)">Imagem ativa</span>
                {{else}}
                    <div style="width:50px; height:50px; background:#1a1a1a; border-radius:50%; display:flex; align-items:center; justify-content:center;">
                        <i data-lucide="user" style="width:20px; color:#444"></i>
                    </div>
                    <span style="font-size: 12px; color: var(--text-muted)">Sem foto</span>
                {{/if}}
            </div>
            
            <div class="form-group">
                <label>Alterar foto:</label>
                <input type="file" name="img" accept="image/*" class="file-custom">
            </div>
            
            <label class="switch-container">
                <input type="checkbox" name="ativo" {{#if this.ativo}}checked{{/if}}>
                <span style="font-size: 14px;">Exibir publicamente no site</span>
            </label>
            
            <button type="submit" class="btn btn-outline">Atualizar Dados</button>
            
            <div style="text-align: center;">
                <a href="/admin/comments/delete/{{this.id}}/{{this.img}}" 
                   class="btn-danger" 
                   onclick="return confirm('Deseja realmente deletar?')">
                   <i data-lucide="trash-2" style="width:14px"></i> Remover Depoimento
                </a>
            </div>
        </form>
    </div>
    {{/each}}
</div>

<script>
    // Inicializa os ícones do Lucide
    lucide.createIcons();
</script>